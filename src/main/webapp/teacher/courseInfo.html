<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/project_detail.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:19:44 GMT -->
<head>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>H+ 后台主题UI框架 - 项目详情</title>
    <meta name="keywords" content="H+后台主题,后台bootstrap框架,会员中心主题,后台HTML,响应式后台">
    <meta name="description" content="H+是一个完全响应式，基于Bootstrap3最新版本开发的扁平化主题，她采用了主流的左右两栏式布局，使用了Html5+CSS3等现代技术">

    <!---->
    <link href="/static/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="/static/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/plugins/simditor/simditor.css"/>
    <link href="/static/css/animate.min.css" rel="stylesheet">
    <link href="/static/css/style.min862f.css?v=4.1.0" rel="stylesheet">
    <link href="/static/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
    <link href="/static/css/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <!---->
    <link rel="shortcut icon" href="/static/img/favicon.ico">
    <link href="/static/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="/static/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">

    <link href="/static/css/animate.min.css" rel="stylesheet">
    <link href="/static/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="/static/css/style.min862f.css?v=4.1.0" rel="stylesheet">


    <!--//////////////-->


</head>

<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">

    <div>
        <div>

        </div>
        <h3>修改信息</h3>
        <form class="m-t col-lg-6 col-lg-offset-2" role="form">


            <div class="form-group">
                课程名: <input id="tableCourseName" type="text" class="form-control" required="" value="">
            </div>

            <div>
                科目：<select id="subject">
                <option value="1">计算机</option>
                <option value="2">数学</option>
                <option value="3">语言</option>
                <option value="4">物理</option>
            </select>
            </div>

            <div class="form-group">
                课程介绍: <textarea id="editor" placeholder="这里输入内容" autofocus
                                name="recordContent"></textarea>
            </div>


            <div class="form-group text-left">
            </div>
            <a onclick='editInfo()' class="btn btn-primary block full-width m-b">保存</a>
            <a onclick="redirectTo('myCourse.html')" class="btn btn-primary block full-width m-b" >取消</a>
            <p>
                <br>
                <br>
                <br>
                <br>



            </p>

        </form>
    </div>

</div>



<div class="row">
    <div class="col-sm-9">
        <div class="wrapper wrapper-content animated fadeInUp">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="m-b-md">
                                <a href="myCourse.html" class="btn btn-white btn-xs pull-right">返回主页</a>
                                <h2 id="courseName">数据结构</h2>
                            </div>
                            <dl class="dl-horizontal">
                                <dt>专业</dt>
                                <dd><span class="label label-primary" id="subjectName">计算机</span>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <dl class="dl-horizontal">

                                <dt>导师：</dt>
                                <dd id="teacherName">杨秋辉</dd>
                                <dt>开设大学：</dt>
                                <dd id="teacherUniversity">四川大学</dd>
                                <dt>导师Email：</dt>
                                <dd><a id="teacherEmail" class="text-navy"> yangqh@scu.edu.cn</a>
                                </dd>
                                <dt>创建日期：</dt>
                                <dd id="courseRegDate">2018/3/25</dd>
                            </dl>
                        </div>
                        <div class="col-sm-7" id="cluster_info">
                            <dl class="dl-horizontal">

                                <dt>开始日期：</dt>
                                <dd id="courseStartDate">2018/4/1</dd>
                                <dt>结束日期：</dt>
                                <dd id="courseEndDate">2018/7/1</dd>
                                <dt>大家都在学：</dt>
                                <dd class="project-people">
                                    <a>
                                        <img alt="image" class="img-circle" src="/static/img/a3.jpg">
                                    </a>
                                    <a>
                                        <img alt="image" class="img-circle" src="/static/img/a1.jpg">
                                    </a>
                                    <a>
                                        <img alt="image" class="img-circle" src="/static/img/a2.jpg">
                                    </a>
                                    <a>
                                        <img alt="image" class="img-circle" src="/static/img/a4.jpg">
                                    </a>
                                    <a>
                                        <img alt="image" class="img-circle" src="/static/img/a5.jpg">
                                    </a>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <dl class="dl-horizontal">
                                <dt>课程热度</dt>
                                <dd>
                                    <div class="progress progress-striped active m-b-sm">
                                        <div style="width: 60%;" class="progress-bar"></div>
                                    </div>
                                    <small>当前课程热度 <strong id="degree"></strong></small>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <div class="row m-t-sm">

                    </div>
                </div>
                <div id="courseIntroduction" class="ibox-content">

                </div>
                <div><a  onclick="addVideo()" class="btn btn-primary block full-width m-b" >添加视频</a></div>
                <div id="videoInfo" class="ibox-content">
                    <table id="exampleTableEvents" data-height="550" data-mobile-responsive="true">


                    </table>

                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <div class="wrapper wrapper-content project-manager">
            <h4>单方合作伙伴</h4>
            <img src="/static/img/bilibili.png" class="img-responsive">
            <p class="small">
                <br>bilibili是国内知名的视频弹幕网站,这里有最及时的视频更新,最棒的ACG氛围,最有创意的Up主。大家可以在这里找到许多欢乐。
            </p>
            <p class="small font-bold">
                <span><i class="fa fa-circle text-warning"></i> </span>

            </p>
            <ul class="tag-list" style="padding: 0">
                <li><a href="http://www.bilibili.tv"><i class="fa fa-tag"></i> 打开</a>
                </li>

            </ul>
            <br><br>
            <h5>项目标签</h5>

            <h5>其他单方伙伴</h5>
            <ul class="list-unstyled project-files">
                <li><a href="http://www.baidu.com"><i class="fa fa-file"></i> 百度</a>
                </li>
                <li><a href="http://www.alibaba.com"><i class="fa fa-file-picture-o"></i> 阿里巴巴</a>
                </li>
                <li><a href="http://www.tencent.com"><i class="fa fa-stack-exchange"></i> 腾讯</a>
                </li>
                <li><a href="http://www.scu.edu.cn"><i class="fa fa-file"></i> 拓思爱诺</a>
                </li>
            </ul>
            <div class="m-t-md">
                <a href="myCourse.html" class="btn btn-xs btn-primary">返回我的课程</a>
                <a href="index_v1.html" class="btn btn-xs btn-primary">返回我的主页</a>

            </div>
        </div>
    </div>
</div>
<!---->


<!--////////////////////////////////////////-->
<script src="/static/js/jquery.min.js?v=2.1.4"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/content.min.js?v=1.0.0"></script>
<script type="text/javascript" src="/static/js/plugins/simditor/module.js"></script>
<script type="text/javascript" src="/static/js/plugins/simditor/uploader.js"></script>
<script type="text/javascript" src="/static/js/plugins/simditor/hotkeys.js"></script>
<script type="text/javascript" src="/static/js/plugins/simditor/simditor.js"></script>
<script src="/static/js/plugins/jasny/jasny-bootstrap.min.js"></script>
<!--<script src="/static/js/jquery.serializejson.min.js"></script>-->
<script src="/static/js/plugins/datapicker/bootstrap-datepicker.js"></script>
<script src="/static/js/plugins/sweetalert/sweetalert.min.js"></script>


<!---->
<script src="/static/js/jquery.min.js?v=2.1.4"></script>
<script src="/static/js/bootstrap.min.js?v=3.3.6"></script>
<script src="/static/js/content.min.js?v=1.0.0"></script>
<script src="../static/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
<script src="../static/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
<script src="../static/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="../static/js/tableExport.js"></script>
<script src="../static/js/bootstrap-table-export.js"></script>


<script>
    $(document).ready(function () {
        var editor = new Simditor(
            {
                textarea: $("#editor"),
                defaultImage: "img/a9.jpg",
                placeholder: ""
            }
        )
    });
</script>
<script src="/static/js/plugins/validate/jquery.validate.min.js"></script>
<script src="/static/js/plugins/validate/messages_zh.min.js"></script>
<script src="/static/js/demo/form-validate-demo.min.js"></script>


<script>
    window.onload = function init() {
        var courseId = getParam("courseId");

        $.get
        ("/user/getCourseInfo.action",
            {
                courseId: courseId

            }, function (result) {
//                    alert(result.data.userId);
                var teacherName = result.data.teacherName;
                var subjectName = result.data.subjectName;
                var courseName = result.data.courseName;
                var courseRegDate = result.data.courseRegDate;
                var courseStartDate = result.data.courseStartDate;
                var courseEndDate = result.data.courseEndDate;
                var teacherEmail = result.data.teacherEmail;
                var teacherUniversity = result.data.teacherUniversity;
                var courseIntroduction = result.data.courseIntroduction;


                if (result === null) {
                    alert("数据错误");
                }
                else {
                    if (result.status === 0) {
                        alert("加载错误")
                    }
                    else {
                        document.getElementById("teacherName").innerHTML = teacherName;
                        document.getElementById("subjectName").innerHTML = subjectName;
                        document.getElementById("courseName").innerHTML = courseName;
                        document.getElementById("courseRegDate").innerHTML = changeDateFormat(courseRegDate);
                        document.getElementById("courseStartDate").innerHTML = changeDateFormat(courseStartDate);
                        document.getElementById("courseEndDate").innerHTML = changeDateFormat(courseEndDate);
                        document.getElementById("teacherEmail").innerHTML = (teacherEmail);
                        document.getElementById("teacherUniversity").innerHTML = (teacherUniversity);
                        document.getElementById("courseIntroduction").innerHTML = (courseIntroduction);


                        $("#tableCourseName").val(courseName);

                        $("#editor").val(courseIntroduction);
                        document.getElementsByClassName("simditor-body")[0].innerHTML = courseIntroduction;
                        document.getElementsByClassName("simditor-placeholder")[0].innerHTML = "";


                    }

//                        alert("状态查询成功");

                }

            }
        )



        $.get
        (
            "/teacher/getSubjectList.action",
            {}, function (result) {

                if (result === null) {
                    alert("数据错误");
                }


                else {
                    var str = "";
                    var len=result.length;
                    var i;
                    for ( i=0;i<len;i++ )
                    { //定义一个变量 s代表索引 in data初始值，进循环才有值
                        var s=result[i];
                        str = str + "<option value='" + s.subjectId + "'>" + s.subjectName + "</option>";
                    }
                    $("#subject").html(str);
                }
            }
        )


    }


    $('#exampleTableEvents').bootstrapTable({
        url: "/user/videoList.action",
        method: "post",
        queryParams: queryParams,
        contentType: "application/x-www-form-urlencoded",

        search: true,
        pagination: true,
        showRefresh: true,
        showToggle: true,
        showColumns: true,
        showExport: true,
        exportDataType: 'all',
        exportTypes: ['json', 'xml', 'csv', 'txt', 'sql', 'excel', 'XLSX', 'pdf'],
        exportOptions: {
            fileName: "data"
        },
        buttonsClass: "default",
        iconSize: "outline",
        toolbar: "#exampleTableEventsToolbar",
        icons: {
            refresh: "glyphicon-repeat",
            toggle: "glyphicon-list-alt",
            columns: "glyphicon-list",
            export: "glyphicon-export icon-share"
        },

        columns: [{
            field: 'videoName',
            title: '视频名称',
            align: 'center',
            valign: 'middle'
        }, {
            field: 'videoIntroduction',
            title: '视频介绍',
            align: 'center',
            valign: 'middle'
        }, {
            field: 'videoCourseId',
            title: '课程号',
            align: 'center',
            valign: 'middle',
        }, {
            field: 'videoUploadDate',
            title: '更新日期',

            sortable: true,
            //——修改——获取日期列的值进行转换
            formatter: function (value, row, index) {
                return changeDateFormat(value)
            }

        }, {
            title: '视频链接',
            field: 'videoId',
            align: 'center',
            formatter: function (value, row, index) {

                var e = '<a href="#" mce_href="#" onclick="deleteVideo(\'' + row.videoId + '\')">删除视频</a> ';
                return e;
            }
        }],


        formatLoadingMessage: function () {
            return "请稍等，正在加载中...";
        },
        formatNoMatches: function () {  //没有匹配的结果
            return '无符合条件的记录';
        },
        onLoadError: function (data) {
            $('#reportTable').bootstrapTable('removeAll');
        },
//        onClickRow: function (row) {
//            window.location.href = "/qStock/qProInfo/" + row.ProductId;
//        },
    });

    function visitVideo(videoId, courseId) {
        redirectTo("videoInfo.html?courseId=" + courseId + "&videoId=" + videoId);


    }


    function queryParams(pageReqeust) {
        //console.log("-----params-----");
        pageReqeust.courseId = getParam("courseId");  //

        return pageReqeust;
    }

    function editInfo() {
        var courseName = $("#tableCourseName").val();
        var courseIntroduction = $("#editor").val();
        var courseSubjectId=$("#subject").val()
        var courseId=getParam("courseId");
//        alert(courseSubjectId);


//        alert(userIntroduction);


        $.post("/teacher/editCourse.action",
            {
                courseId: courseId,
                courseName:courseName,
                courseSubjectId: courseSubjectId,
                courseIntroduction: courseIntroduction
            },

            function (result) {

                if (result === 0) {
                    alert("保存失败!");
                }
                else {
                    alert("保存成功!");
                    location.reload();

                }
            });
    }

    function getParam(paramName) {
        paramValue = "", isFound = !1;
        if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=") > 1) {
            arrSource = unescape(this.location.search).substring(1, this.location.search.length).split("&"), i = 0;
            while (i < arrSource.length && !isFound) arrSource[i].indexOf("=") > 0 && arrSource[i].split("=")[0].toLowerCase() == paramName.toLowerCase() && (paramValue = arrSource[i].split("=")[1], isFound = !0), i++
        }
        return paramValue == "" && (paramValue = null), paramValue;
    }

    function changeDateFormat(cellval) {
        if (cellval === null) {
            return "暂无信息";
        }
        cellval = cellval.toString();
        if (cellval !== null) {
            var date = new Date(parseInt(cellval.replace("/Date(", "").replace(")/", ""), 10));
            var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
            var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
            return date.getFullYear() + "-" + month + "-" + currentDate;
        }
    }

    function redirectTo(address) {
        window.location = address;

    }
    function addVideo() {
        redirectTo("addVideo.html?courseId="+getParam("courseId"));

    }


    function deleteVideo(videoId) {
        swal({
            title: "您确定要删除这条信息吗",
            text: "删除后将无法恢复，请谨慎操作！",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "是的，我要删除！",
            cancelButtonText: "让我再考虑一下…",
            closeOnConfirm: false,
            closeOnCancel: true
        });

        $.post("/teacher/deleteVideo.action",
            {
                videoId:videoId
            },
            function (result) {
                if(result===1)
                {
                    swal("删除成功");
                    location.reload();
                }
                else{

                    alert("删除失败!此视频已不存在！");
                    location.reload();
                }

            });

    }

</script>
<!--<script type="text/javascript" src="http://tajs.qq.com/stats?sId=9051096" charset="UTF-8"></script>-->


</body>


<!-- Mirrored from www.zi-han.net/theme/hplus/project_detail.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:19:44 GMT -->
</html>
